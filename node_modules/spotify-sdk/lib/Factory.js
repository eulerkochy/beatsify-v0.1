'use strict';

Object.defineProperty(exports, '__esModule', {
    value: true
});

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _handlersArtistHandler = require('./handlers/ArtistHandler');

var _handlersArtistHandler2 = _interopRequireDefault(_handlersArtistHandler);

var _handlersAlbumHandler = require('./handlers/AlbumHandler');

var _handlersAlbumHandler2 = _interopRequireDefault(_handlersAlbumHandler);

var _handlersTrackHandler = require('./handlers/TrackHandler');

var _handlersTrackHandler2 = _interopRequireDefault(_handlersTrackHandler);

var _handlersPlaylistHandler = require('./handlers/PlaylistHandler');

var _handlersPlaylistHandler2 = _interopRequireDefault(_handlersPlaylistHandler);

var _handlersUserHandler = require('./handlers/UserHandler');

var _handlersUserHandler2 = _interopRequireDefault(_handlersUserHandler);

var _handlersCollectionHandler = require('./handlers/CollectionHandler');

var _handlersCollectionHandler2 = _interopRequireDefault(_handlersCollectionHandler);

var _Client = require('./Client');

var _Client2 = _interopRequireDefault(_Client);

var Factory = function Factory(data) {
    var _type;
    var _items;
    var _source;

    if (data.error) {
        return data.error;
    } else if (Object.keys(data).length === 1 && data.snapshot_id) {
        return data;
    }

    // a lot of magic happens here :D
    if (data.type) {
        _type = data.type;
        _items = data;
    } else if (typeof Object.keys(data)[0] === 'string' && !Array.isArray(data) && !data.items) {
        _type = Object.keys(data)[0];
        _items = data[_type].items || data[_type];
        _source = data[_type];
    } else if (Array.isArray(data)) {
        _type = data[0].type + 's';
        _items = data;
    } else if (Array.isArray(data.items) && data.items[0].type) {
        _type = data.items[0].type + 's';
        _items = data.items;
        _source = data;
    } else if (Array.isArray(data.items) && !data.items[0].type) {
        _items = data.items;
        _type = Object.keys(data.items[0])[3] + 's';
        _source = data;
    }

    switch (_type) {
        case 'track':
            return new _handlersTrackHandler2['default']().convert(_items);
            break;
        case 'tracks':
            return new _handlersCollectionHandler2['default'](_items, _handlersTrackHandler2['default'], _source);
            break;
        case 'playlist':
            return new _handlersPlaylistHandler2['default']().convert(_items);
            break;
        case 'playlists':
            return new _handlersCollectionHandler2['default'](_items, _handlersPlaylistHandler2['default'], _source);
            break;
        case 'artists':
            return new _handlersCollectionHandler2['default'](_items, _handlersArtistHandler2['default'], _source);
            break;
        case 'album':
            return new _handlersAlbumHandler2['default']().convert(_items);
            break;
        case 'albums':
            return new _handlersCollectionHandler2['default'](_items, _handlersAlbumHandler2['default'], _source);
            break;
        case 'user':
            return new _handlersUserHandler2['default']().convert(_items);
            break;
        default:
            return _Client2['default'].instance.request(data.href);
    }
};

exports['default'] = function (data) {
    return new Factory(data);
};

;
module.exports = exports['default'];